# Описание

Шаблон для мультиязычного сайта компании. Страницы сайта храняться как html файлы на сервере и запрашиваются по Ajax fetch API. Количество страниц и языков не ограниченно. Дополнительная функциональность: автоопределение языка, переключение языка, предзагрузка содержания, автоподстановка года в футер. Технологии: HTML/CSS/Vanilla JavaScript. В качестве примера используется для вебсайта компании ООО Предприятие Первичной Переработки Древесины (ООО ПППД), домен pppd.ooo.

## Добавление контента

Содержание главной страницы, хедера, футера на всех языках находится и добавляется в index.html. 
Для добавления новой страницы на сайт надо добавить html файл с именем pageId в формате:

    <pageName>-<language>.html 
        about-ru.html   <-- русская версия страницы about
        about-en.html   <-- английская версия страницы about  

Тогда она будет доступна, и на нее можно будет ссылаться по следующей ссылке:

    pppd.ooo/#/<language>/<pageName>/<anchor>

        pppd.ooo/#/ru   <-- главная 
        pppd.ooo/#/ru/production   <-- русская версия страницы about
        pppd.ooo/#/en/production/euro-batten   <-- английская версия страницы продукции, раздел euro-batten    

## Обработка ошибок адреса

- Если версия страницы, хедера, футера для соответствующего языка не будет найдена, то используется язык по умолчанию (переменная defaultLanguage из main.js). 
- Если сама страница не существует, или возникла ошибка при загрузке, будет загружена страница по умолчанию - главная страница 
- TODO: выбор страницы по умолчанию тоже можно было бы сделать опциональным defaultPage. 
- DRAWBACK: нет перенаправления на адрес при возникновении ошибки, а просто подставляется нужная страница. Сейчас адреса с хэшем /#jkjkj проходят в вызов openPage не меняя адрес в адресной строке, а /#/, /#// еще и передают пустую строку в аргументы (аргументы по умолчанию в js функциях подставляются только при undefined). Перенаправление следует сделать сразу в роутере.   

## Загрузка контента

Страницы для предзагрузки определяются в массиве в preloader.js Также, для image и iframe страницы production использована ленивая загрузка loading='lazy'. Что и как загружать надо настраивать индивидуально. Однако, браузеры могут трактовать директиву loading='lazy' по своему усмотрению и загружать контент сразу. Для большего контроля ленивой загрузки надо использовать специальную библиотеку lazy-load.js

# Структура index.html

    body
        nav#menu-ru 
        nav#menu-en
        ...
        main
            #main-ru.main-page
                .page-title
                .page-description
                .page-content
            #main-en.main-page    
            ...    
            #pages
        footer#footer-ru
            span.period
        footer#footer-en
            span.period
        ...

# Структура pageId.html
    pageId = <pageName>-<language>

    #pageId.page
        .page-title
        .page-description
        .page-content

# Описание js файлов

## footer.js
Вставка года в футер. Место вставки определяется по классу .period

## preloader.js
Предзагрузка страниц, чьи pageId перечисленны в массиве; Оформлен в виде функции для единообразия.

## router.js
При изменении адреса (url), а точнее его хэш части, вызывается router().
Вызов происходит в трех случаях:
1. После загрузки index.html вызывается функция checkLanguage(). Если переход был по адресу без хэша, то к нему добавляется язык (и хэш изменяется вызовом emitAction()). Если переход был по адресу с хэшем, то роутер вызывается напрямую. Роутер разбирает адрес функцией getPath() и отображает соответствующую страницу вызовом openPage() из основного модуля.
2. При переходе по внутренним ссылкам.
3. При изменении языка вызывается функция changeLanguage(), которая подставляет в адрес нужный язык.

### changeLanguage()
Вызывается на onclick

### router()
Вызывается на изменение хэш части адреса 

### getPath()
Функция разбора адреса.

pathString это часть адреса после хеша:

     pathString = <language>/<pageName>/<anchor>

path это массив:

     path = [<language>, <pageName>, <anchor>] 

## main.js

### loadPage()
Загружает страницу в div#pages, если она уже не была загружена. 

### openPage()
Делает нужные блоки видимыми, меняет метаинформацию.
